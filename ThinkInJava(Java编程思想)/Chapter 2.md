# Chapter 2 一切都是对象

## 2.1 用句柄操作对象

在Java里,任何东西都可看作对象。因此,采用一种统一的语法,任何地方均可照搬不误。尽管将一切都“看作”对象,但操纵的标识符实际是指向一个对象的“句柄”(Handle)。类似C++的“引用”和“指针”。

String s;

这里创建的只是句柄,并不是对象。

## 2.2 所有对象都必须创建

创建句柄时,我们希望它同一个新对象连接。通常用new关键字达到这一目的。

String s = new String("asdf");

### 2.2.1  保存在什么地方

六个保存数据的地方：
1. 寄存器。只有汇编语言可以访问。
2. 堆栈。 创建程序时,Java 编译器必须准确地知道堆栈内保存的所有数据的“长度”以及“存在时间”。这是由于它必须生成相应的代码,以便向上和向下移动指针。这一限制无疑影响了程序的灵活性,所以尽管有些 Java 数据要保存在堆栈里——特别是对象句柄,但 Java 对象并不放到其中。
3. 堆。 保存了Java对象。
4. 静态存储。 “静态”(Static)是指“位于固定位置”(尽管也在RAM里)。程序运行期间,静态存储的数据将随时等候调用。可用static关键字指出一个对象的特定元素是静态的。
5. 常数存储。 常数值通常直接置于程序代码内部。永远都不会改变。
6. 非RAM存储。 数据完全独立于一个程序之外,则程序不运行时仍可存在,并在程序的控制范围之外。其中两个最主要的例子便是“流式对象”和“固定对象”。

### 2.2.2 主要类型

数值类型全都是有符号(正负号)的,不存在无符号类型。

|主类型 |大小 |最小值 |最大值 |封装器类型|
|-|-|-|-|-|
|boolean |1 位 |- |- |Boolean|
|char |16 位 |Unicode 0 |Unicode 2^16-1 |Character|
|byte |8 位 |-128 |+127 |Byte(注释1)|
|short |16 位 |-2^15 |+2^15-1 |Short(注释1)|
|int |32 位 |-2^31 |+2^31-1 |Integer|
|long |64 位 |-2^63 |+2^63-1 |Long|
|float |32 位 |IEEE754 |IEEE754 |Float|
|double |64 位 |IEEE754 |IEEE754 |Double|
|Void |- |- |- |Void(注释1)|

注释1:到 Java 1.1 才有,1.0 版没有。

主数据类型拥有自己的“封装器”(wrapper)类。可以使用对应的封装器在堆内实例化一个对象表示主类型。
例如:
```
char c = 'x';
Character C = new Character('c');
也可以直接使用:
Character C = new Character('x');
```
高精度的计算:BigInteger和BigDecimal，没有对应的“主类型”。能对int或float做的操纵,对BigInteger和BigDecimal一样可以做。只是必须使用方法调用,不能使用运算符。BigInteger支持任意精度的整数。BigDecimal支持任意精度的定点数字。


### 2.2.3 Java的数组

创建对象数组时,实际创建的是一个句柄数组。而且每个句柄都会自动初始化成一个特殊值,并带有自己的关键字:null(空)。一旦Java看到null,就知道该句柄并未指向一个对象。正式使用前,必须为每个句柄都分配一个对象。


## 2.3 绝对不要清除对象

Java有一个特别的“垃圾收集器”,它会查找用new创建的所有对象,并辨别其中哪些不再被引用。随后,它会自动释放由那些闲置对象占据的内存,以便能由新对象使用。这意味着我们根本不必操心内存的回收问题。只需简单地创建对象,一旦不再需要它们,它们就会自动离去。

## 2.4 新建数据类型:类

关键字“class”。

1. 主成员的默认值
若某个主数据类型属于一个类成员,那么即使不明确(显式)进行初始化,也可以保证它们获得一个默认
值。
|主类型 |默认值|
|-|-|
|Boolean |false|
|Char |'\u0000'(null)|
|byte |(byte)0|
|short |(short)0|
|int |0|
|long |0L|
|float |0.0f|
|double 0.0d|

## 2.5 方法、自变量和返回值

Java的“方法”决定了一个对象能够接收的消息。最基本的形式:
```
返回类型 方法名( /* 自变量列表*/ ) {/* 方法主体 */}
```
Java的方法只能作为类的一部分创建。
